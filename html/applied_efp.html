<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FMO: Applied flexible EFP &mdash; EFP documentation 0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=10f1778b"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="QM/EFP" href="qmefp.html" />
    <link rel="prev" title="Flexible EFP" href="flexible_efp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            EFP documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="learn_more.html">Learn more about EFP</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">EFP gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EFP in a nutshell</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="parameters.html">EFP paramters</a></li>
<li class="toctree-l1"><a class="reference internal" href="efpmd.html">EFPMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="efp_calcs.html">EFP calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="bioefp.html">BioEFP</a></li>
<li class="toctree-l1"><a class="reference internal" href="flexible_efp.html">Flexible EFP</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">FMO: Applied flexible EFP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#efp-workflow">EFP Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qmefp.html">QM/EFP</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software, tools, and tips</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="libefp.html">LibEFP</a></li>
<li class="toctree-l1"><a class="reference internal" href="gamess.html">Computing EFP parameters in GAMESS</a></li>
<li class="toctree-l1"><a class="reference internal" href="qchem.html">Q-Chem</a></li>
<li class="toctree-l1"><a class="reference internal" href="psi4.html">PSI4</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EFP bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="papers.html">Original publications by Mark Gordon’s group</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#review-papers">Review papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#book-chapters">Book chapters</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#development-of-efp-terms">Development of EFP terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#macromolecules-and-flexible-fragments">Macromolecules and flexible fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#software-development">Software development</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#qm-efp-models">QM/EFP models</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#accuracy-benchmarks">Accuracy benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html#applications">Applications</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EFP documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">FMO: Applied flexible EFP</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/applied_efp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fmo-applied-flexible-efp">
<span id="applied-efp"></span><h1>FMO: Applied flexible EFP<a class="headerlink" href="#fmo-applied-flexible-efp" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>As is the case with many photoactive proteins,computational methods struggle to reproduce
experimental spectra for the Fenna-Matthews-Olson complex (FMO). Work by
<a class="reference external" href="https://pubs.acs.org/doi/full/10.1021/acs.jpclett.9b03486">Kim et al</a> shows that
flexible QM/EFP can be applied to FMO to correctly generate computational results in
quantitative agreement to experimental spectra.</p>
<p>The key to applying EFP to your system is to carefully define the active site and EFP region.
FMO is a trimeric protein with eight bacteriochloropyll a (BChl) pigments in each monomer.
FMO completes energy transfer via excitonic couplings across these eight BChls. A summary
of the complete workflow that was performed is the following: 1) molecular dynamics (MD)
simiulations of the FMO protein in water and counter ions, 2) QM/MM (not EFP) geometry
optimization of <em>each</em> active site (active sites consist of one BChl pigment and
typically 3 H-bonding amino acids), and 3) flex-EFP excited state energy calculations of
each pigment.</p>
<p>In the case of FMO, these steps must be repeated on several snapshots from MD to account
for variation in the resting state of the structure, and the QM region must be defined
carefully in both the QM/MM and flex-EFP stages. It might not be universally true that one
must perform QM/MM geometry optimization. This page is a walkthrough for the flex-EFP procedure
only. Molecular dynamics and QM/MM optimizations are assumed to be complete for your
system prior to these steps.</p>
<a class="reference internal image-reference" href="_images/FMO_trimer_BCLs.bmp"><img alt="_images/FMO_trimer_BCLs.bmp" src="_images/FMO_trimer_BCLs.bmp" style="width: 350px;" /></a>
<a class="reference internal image-reference" href="_images/FMO_mon_pigs.bmp"><img alt="_images/FMO_mon_pigs.bmp" src="_images/FMO_mon_pigs.bmp" style="width: 400px;" /></a>
<p>You will need a structure file (.g96) and topology information (.top, for atom charges). In this specific case,
a structure file is extracted from a GROMACS molecular dynamics trajectory and all water molecules more than 15 angstroms from
the protein’s surface have been removed. For a chlorophyll-containing protein, you will likely want to optimize the geometry
of each active chlorophyl molecule (with very close amino acids/water molecules) separately with more standard QM/MM approaches
before proceeding with EFP calculations on the optimized geometry. For this example, the first BChl, residue number 359,
has been optimized and will be the QM region for the EFP calcuation.</p>
<a class="reference internal image-reference" href="_images/fmo_waters15a.bmp"><img alt="_images/fmo_waters15a.bmp" src="_images/fmo_waters15a.bmp" style="width: 400px;" /></a>
<p>First, an EFP region must be defined. Every amino acid, (non QM) BChl, and water molecule containing an
atom within 15 angstroms of the QM BChl headring.</p>
<p>The headring is defined by atomnames: MG CHA CHB HB CHC HC CHD HD NA C1A
C2A H2A C3A H3A C4A CMA HMA1 HMA2 HMA3 NB C1B C2B C3B C4B CMB HMB1 HMB2 HMB3 CAB OBB CBB HBB1 HBB2 HBB3 NC C1C C2C H2C C3C
H3C C4C CMC HMC1 HMC2 HMC3 CAC HAC1 HAC2 CBC HBC1 HBC2 HBC3 ND C1D C2D C3D C4D CMD HMD1 HMD2 HMD3 CAD OBD CBD HBD CGD O1D O2D
CED HED1 HED2 HED3</p>
<p>The headring surrounded by EFP region looks like this:</p>
<a class="reference internal image-reference" href="_images/tester.bmp"><img alt="_images/tester.bmp" src="_images/tester.bmp" style="width: 400px;" /></a>
<p>EFP is, of course, a fragmentation method. The protein residues within the 15 angstrom cutoff will be expressed individually.
Because amino acids are a continuous chain, we will need to break each residue into its own fragment. Chemically, we would like
to divide each residue by the C-C backbone bond, however, standard PDB listing convention divides residues by the C-N
bond. To correct this, ‘C’ and ‘O’ atom names should be included in the following aminoc acid. This way the ‘C’ and ‘CA’
(carbonyl carbon and alpha carbon respectively) bond is the division between bonded fragments.
See the examples below:</p>
<p>PDB residues are divided like this:</p>
<a class="reference internal image-reference" href="_images/pdb_67_col.bmp"><img alt="_images/pdb_67_col.bmp" src="_images/pdb_67_col.bmp" style="width: 400px;" /></a>
<dl class="simple">
<dt>For EFP, we would rather these two fragments</dt><dd><p>look like this:</p>
</dd>
</dl>
<a class="reference internal image-reference" href="_images/efp_67_col.bmp"><img alt="_images/efp_67_col.bmp" src="_images/efp_67_col.bmp" style="width: 400px;" /></a>
<p>The desired atoms are contained in the structure file, but they do not completely ‘agree’ with the amino acid numbering.
Below is a snippet from the structure file with the desired EFP fragment 8 highlighted. Note that atom names ‘C’ and ‘O’
have to be included in the following fragment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">N</span>         <span class="mi">75</span>    <span class="mf">8.197564125</span>    <span class="mf">5.794843197</span>    <span class="mf">8.932806015</span>
<span class="linenos"> 2</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">H</span>         <span class="mi">76</span>    <span class="mf">8.192337036</span>    <span class="mf">5.702930450</span>    <span class="mf">8.974348068</span>
<span class="linenos"> 3</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">CA</span>        <span class="mi">77</span>    <span class="mf">8.135135651</span>    <span class="mf">5.905285358</span>    <span class="mf">9.013648987</span>
<span class="linenos"> 4</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">HA</span>        <span class="mi">78</span>    <span class="mf">8.211915970</span>    <span class="mf">5.982574940</span>    <span class="mf">9.010185242</span>
<span class="linenos"> 5</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">CB</span>        <span class="mi">79</span>    <span class="mf">8.009770393</span>    <span class="mf">5.969236851</span>    <span class="mf">8.948612213</span>
<span class="linenos"> 6</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">HB1</span>       <span class="mi">80</span>    <span class="mf">8.050425529</span>    <span class="mf">6.006968021</span>    <span class="mf">8.854780197</span>
<span class="linenos"> 7</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">HB2</span>       <span class="mi">81</span>    <span class="mf">7.976262569</span>    <span class="mf">6.059305668</span>    <span class="mf">9.000051498</span>
<span class="linenos"> 8</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">OG</span>        <span class="mi">82</span>    <span class="mf">7.902407169</span>    <span class="mf">5.881231785</span>    <span class="mf">8.930030823</span>
<span class="linenos"> 9</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">HG</span>        <span class="mi">83</span>    <span class="mf">7.854612350</span>    <span class="mf">5.871961117</span>    <span class="mf">9.012769699</span>
<span class="hll"><span class="linenos">10</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">C</span>         <span class="mi">84</span>    <span class="mf">8.119274139</span>    <span class="mf">5.871285915</span>    <span class="mf">9.162454605</span>
</span><span class="hll"><span class="linenos">11</span>    <span class="mi">6</span> <span class="n">SER</span>   <span class="n">O</span>         <span class="mi">85</span>    <span class="mf">8.113216400</span>    <span class="mf">5.752573967</span>    <span class="mf">9.194147110</span>
</span><span class="hll"><span class="linenos">12</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">N</span>         <span class="mi">86</span>    <span class="mf">8.130512238</span>    <span class="mf">5.972802639</span>    <span class="mf">9.251754761</span>
</span><span class="hll"><span class="linenos">13</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">H</span>         <span class="mi">87</span>    <span class="mf">8.164965630</span>    <span class="mf">6.064530373</span>    <span class="mf">9.227258682</span>
</span><span class="hll"><span class="linenos">14</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">CA</span>        <span class="mi">88</span>    <span class="mf">8.116546631</span>    <span class="mf">5.955110073</span>    <span class="mf">9.394023895</span>
</span><span class="hll"><span class="linenos">15</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">HA</span>        <span class="mi">89</span>    <span class="mf">8.056267738</span>    <span class="mf">5.864906311</span>    <span class="mf">9.404546738</span>
</span><span class="hll"><span class="linenos">16</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">CB</span>        <span class="mi">90</span>    <span class="mf">8.253267288</span>    <span class="mf">5.924880028</span>    <span class="mf">9.449047089</span>
</span><span class="hll"><span class="linenos">17</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">HB1</span>       <span class="mi">91</span>    <span class="mf">8.315284729</span>    <span class="mf">6.014496803</span>    <span class="mf">9.450969696</span>
</span><span class="hll"><span class="linenos">18</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">HB2</span>       <span class="mi">92</span>    <span class="mf">8.300686836</span>    <span class="mf">5.853493214</span>    <span class="mf">9.381696701</span>
</span><span class="hll"><span class="linenos">19</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">CG</span>        <span class="mi">93</span>    <span class="mf">8.254477501</span>    <span class="mf">5.874156475</span>    <span class="mf">9.598213196</span>
</span><span class="hll"><span class="linenos">20</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">OD1</span>       <span class="mi">94</span>    <span class="mf">8.363140106</span>    <span class="mf">5.875256538</span>    <span class="mf">9.659650803</span>
</span><span class="hll"><span class="linenos">21</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">OD2</span>       <span class="mi">95</span>    <span class="mf">8.154453278</span>    <span class="mf">5.827357292</span>    <span class="mf">9.662918091</span>
</span><span class="linenos">22</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">C</span>         <span class="mi">96</span>    <span class="mf">8.047140121</span>    <span class="mf">6.075501442</span>    <span class="mf">9.452131271</span>
<span class="linenos">23</span>    <span class="mi">7</span> <span class="n">ASP</span>   <span class="n">O</span>         <span class="mi">97</span>    <span class="mf">8.090898514</span>    <span class="mf">6.191641331</span>    <span class="mf">9.434694290</span>
</pre></div>
</div>
<p>Next, the BChl molecules are closer than the 15 angstrom cutoff, so they also appear in the EFP region. It is more cost efficient
to treat BChl fragments as separate head and tail groups as is shown below:</p>
<p>In the case of both amino acid and BChl fragments, we have at least one broken bond; we cannot simply compute a fragment that is
missing an atomic bond. To solve this, we will introduce virtual hydrogen atoms to ‘cap’ the broken bonds. Non terminal
amino acid fragments will have two virtual atoms. The first is between the alpha carbon of the previous residue and the
carbonyl carbon of the current residue; the other is similarly between the alpha carbon of the current residue and the carbonyl carbon
of the following residue. The BChl fragments are split between atoms ‘C2A’ and ‘CAA.’ One virtual atom will be added to both
head and tail fragments between these atoms. Virtual atoms are added along the vector of the broken bonds with the distance changed
to the C-H equilibrium bond distance, 1.09 angstroms.</p>
<p>Once the system is properly fragmented, we can finally run EFP calculations in the precense of the polarizable, solvatochromic environment.</p>
</section>
<section id="efp-workflow">
<h2>EFP Workflow<a class="headerlink" href="#efp-workflow" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="flexible_efp.html" class="btn btn-neutral float-left" title="Flexible EFP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="qmefp.html" class="btn btn-neutral float-right" title="QM/EFP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>